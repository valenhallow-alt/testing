-- Replace the existing Event tab section with this block

-- EVENT tab (updated with divider and dropdowns)
local Event = Window:CreateTab("Event", 125058207637011)
Event:CreateSection("Event")

-- keep existing event toggles/state if any
local AutoGiftSanta = false
local AutoFrameEvent = false

-- Divider and new dropdowns
Event:CreateDivider()

-- Tadpoles dropdown options (in requested order)
local TadpolesOptions = {
    "Woodtoy Tadpole",
    "Gift Tadpole",
    "Snow Tadpole",
    "Nutcracker Tadpole",
    "Festive Lights Tadpole",
    "Gingerbread Tadpole",
    "Festive Tree Tadpole",
    "Ribbitolph Tadpole",
    "Santa Tadpole"
}

-- Gears dropdown (left empty for now)
local GearsOptions = {
    -- intentionally left blank per request
}

-- Decorations / Furniture options (in requested order)
local FurnitureOptions = {
    "Present","Ornament 1","Ornament 2","Ornament 3","Ornament 4","Christmas Stockings",
    "Candy Cane","Short Christmas Lights","Holly","Gingerbread Wall [1x1]","Gingerbread Wall [3x1]",
    "Gingerbread Wall [3x2]","Christmas Lights","Christmas Bow","Gingerbread Path","Candy Cane Arch",
    "Christmas Wreath","Christmas Arch","Christmas Bush Pot","Short Garland","Long Garland",
    "Snowfrog","Christmas Tree","Christmas Star"
}

-- Current selections
local SelectedTadpoles = {}
local SelectedGears = {}
local SelectedFurniture = {}

-- Create dropdowns
local ddTadpoles = Event:CreateDropdown({
    Name = "Tadpoles",
    Options = TadpolesOptions,
    CurrentOption = {"None"},
    MultipleOptions = true,
    Flag = "Event_Tadpoles",
    Callback = function(Value)
        SelectedTadpoles = Value or {}
    end
})

local ddGears = Event:CreateDropdown({
    Name = "Gears",
    Options = GearsOptions,
    CurrentOption = {"None"},
    MultipleOptions = true,
    Flag = "Event_Gears",
    Callback = function(Value)
        SelectedGears = Value or {}
    end
})

local ddFurniture = Event:CreateDropdown({
    Name = "Furniture",
    Options = FurnitureOptions,
    CurrentOption = {"None"},
    MultipleOptions = true,
    Flag = "Event_Furniture",
    Callback = function(Value)
        SelectedFurniture = Value or {}
    end
})

-- Helper: convert a tadpole name to its frog counterpart (simple replace "Tadpole" -> "Frog")
local function TadpoleToFrogName(tadName)
    if not tadName then return tadName end
    local frogName = tadName:gsub("Tadpole", "Frog")
    frogName = frogName:gsub("%s+$", ""):gsub("^%s+", "")
    return frogName
end

-- Buy Tads toggle: will iterate selected tadpoles and call the purchase remote 3 times per name
local BuyTads = false
Event:CreateToggle({
    Name = "Buy Tads",
    CurrentValue = false,
    Flag = "Event_Buy_Tads",
    Callback = function(Value)
        BuyTads = Value
        if Value then
            task.spawn(function()
                while BuyTads do
                    -- iterate over a copy to avoid mutation issues
                    local toBuy = {}
                    for _, v in ipairs(SelectedTadpoles or {}) do
                        if v and v ~= "None" and v ~= "" then table.insert(toBuy, v) end
                    end

                    for _, tadName in ipairs(toBuy) do
                        if not BuyTads then break end
                        local frogName = TadpoleToFrogName(tadName)
                        for i = 1, 3 do
                            if not BuyTads then break end
                            pcall(function()
                                local args = { tadName, frogName }
                                game:GetService("ReplicatedStorage"):WaitForChild("HollyhopShopComms"):WaitForChild("RF"):WaitForChild("OnPurchaseItem"):InvokeServer(unpack(args))
                            end)
                            task.wait(0.35)
                        end
                        task.wait(0.4)
                    end

                    -- small pause between full cycles
                    for i = 1, 10 do
                        if not BuyTads then break end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end,
})

-- Buy Decorations toggle: will iterate selected furniture and call the purchase remote 3 times per name
local BuyDecorations = false
Event:CreateToggle({
    Name = "Buy Decorations",
    CurrentValue = false,
    Flag = "Event_Buy_Decorations",
    Callback = function(Value)
        BuyDecorations = Value
        if Value then
            task.spawn(function()
                while BuyDecorations do
                    local toBuy = {}
                    for _, v in ipairs(SelectedFurniture or {}) do
                        if v and v ~= "None" and v ~= "" then table.insert(toBuy, v) end
                    end

                    for _, itemName in ipairs(toBuy) do
                        if not BuyDecorations then break end
                        for i = 1, 3 do
                            if not BuyDecorations then break end
                            pcall(function()
                                local args = { itemName }
                                game:GetService("ReplicatedStorage"):WaitForChild("HollyhopShopComms"):WaitForChild("RF"):WaitForChild("OnPurchaseItem"):InvokeServer(unpack(args))
                            end)
                            task.wait(0.35)
                        end
                        task.wait(0.4)
                    end

                    for i = 1, 10 do
                        if not BuyDecorations then break end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end,
})

-- Note: Gears dropdown left intentionally blank per request. You can add a toggle and logic later similar to above.
